(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f651f2e"],{2600:function(e,t,a){"use strict";a.r(t);var i,l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("div",{staticClass:"main clearfix",style:{"margin-left":e.$store.state.app.isCollapse?"84px":"240px"}},[i("div",{staticClass:"main_container"},[i("querys",{attrs:{showSwitch:!1}},[i("div",{attrs:{slot:"queryTabs"},slot:"queryTabs"},[i("div",{staticClass:"query_tab"},[i("div",{staticClass:"query_label"},[e._v("项目名称")]),i("div",{staticClass:"query_select"},[i("el-input",{attrs:{size:"small",placeholder:"请输入关键词"},on:{change:function(t){return e.selectBatch()}},model:{value:e.param.itemName,callback:function(t){e.$set(e.param,"itemName",t)},expression:"param.itemName"}})],1)]),i("div",{staticClass:"query_tab"},[i("div",{staticClass:"query_label"},[e._v("所属单位")]),i("div",{staticClass:"query_select"},[i("select-tree",{on:{getValue:e.getValue}})],1)]),i("div",{staticClass:"query_tab"},[i("div",{staticClass:"query_label"},[e._v("批次名称")]),i("div",{staticClass:"query_select"},[i("el-input",{attrs:{type:"text",clearable:"",size:"small",placeholder:"请输入"},on:{change:e.selectBatch},model:{value:e.queryBatchMode,callback:function(t){e.queryBatchMode=t},expression:"queryBatchMode"}})],1)]),i("div",{staticClass:"query_tab"},[i("div",{staticClass:"query_label"},[e._v("专业类别")]),i("div",{staticClass:"query_select"},[i("el-select",{attrs:{clearable:"",placeholder:"请选择",size:"small"},on:{change:e.selectBatch},model:{value:e.param.speciality,callback:function(t){e.$set(e.param,"speciality",t)},expression:"param.speciality"}},e._l(e.selectParamDict.get("speciality"),(function(e){return i("el-option",{key:e.codeValue,attrs:{label:e.codeName,value:e.codeValue}})})),1)],1)]),i("div",{staticClass:"query_tab"},[i("div",{staticClass:"query_label",staticStyle:{width:"85px !important"}},[e._v("评审计划状态")]),i("div",{staticClass:"query_select",staticStyle:{"margin-left":"85px !important"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择",size:"small"},on:{change:function(t){return e.selectBatch()}},model:{value:e.param.planStatus,callback:function(t){e.$set(e.param,"planStatus",t)},expression:"param.planStatus"}},e._l(e.planStatusList,(function(e){return i("el-option",{key:e.codeValue,attrs:{label:e.codeName,value:e.codeValue}})})),1)],1)])]),i("div",{attrs:{slot:"queryBtns"},slot:"queryBtns"},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submitAssessment}},[e._v("提交")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.showDialogPackaging}},[e._v("打包")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.showBatchPackage}},[e._v("包调整")])],1)]),i("div",{staticClass:"template_main"},[i("div",{staticClass:"template_left"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.timeListloading,expression:"timeListloading"}],ref:"tableLeft",staticClass:"plan-table",attrs:{data:e.colTimeList,height:e.tableHeight,border:"","header-cell-style":{background:"#359691",color:"#fff"},"row-class-name":"row","cell-class-name":"column","highlight-current-row":!0,"row-key":"batchId"},on:{"current-change":e.handleChangeColTimeList}},[i("el-table-column",{attrs:{label:"评审计划批次",prop:"batchName"}})],1)],1),i("div",{staticClass:"template_right"},[i("div",{staticClass:"table-item-box"},[i("div",{class:e.showDrawer?"table-wrapper-run":"table-wrapper-init"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableDataLoading,expression:"tableDataLoading"}],ref:"singleTable",attrs:{data:e.tableDataShow,height:e.tableHeight,border:"","header-cell-style":{background:"#359691",color:"#fff"},"row-class-name":e.tableRowClassName,"cell-class-name":"column",lazy:"",load:e.tableLoad,"row-key":"randomId","tree-props":{children:"children"}},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",selectable:e.isSelectable,width:"45"}}),i("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),e._l(e.tableLabel,(function(t,a){return"itemName"!=t.colDname&&"auditPlanStatus"!=t.colDname&&1==t.showType?i("el-table-column",{key:a,attrs:{prop:t.colDname,label:t.dispName,"min-width":"220","show-overflow-tooltip":!0}}):"itemName"==t.colDname?i("el-table-column",{attrs:{label:t.dispName,width:"200","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.isBatchPackage?i("span",[e._v(e._s(t.row.itemName))]):i("span",{staticClass:"blue",on:{click:function(a){return e.showDetailDialog(t.row)}}},[e._v(e._s(t.row.itemName))])]}}])}):"auditPlanStatus"==t.colDname?i("el-table-column",{attrs:{label:t.dispName,width:"200","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return["未通过"==t.row.auditPlanStatus?i("span",{staticClass:"blue",on:{click:function(a){return e.showReasonDialog(t.row)}}},[e._v(e._s(t.row.auditPlanStatus))]):i("span",[e._v(e._s(t.row.auditPlanStatus))])]}}])}):e._e()})),i("el-table-column",{attrs:{label:"操作",width:"200","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.isEdit?i("span"):"已通过"==t.row.auditPlanStatus||"已提交"==t.row.auditPlanStatus?i("span",{staticStyle:{color:"gray"}},[e._v("编辑评审计划")]):i("span",{staticClass:"blue",on:{click:function(a){return e.showDialogPlan(t.row)}}},[e._v("编辑评审计划")])]}}])})],2),i("div",{staticClass:"page"},[i("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":20,"page-sizes":[10,20,30,50],layout:"sizes, total, prev, pager, next, jumper",total:e.totalNum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),i("div",{staticClass:"planDrawer",class:e.showDrawer?"item-add-wrapper-run":"item-wrapper-init"},[e.showDrawer?i("item-add-com",{key:e.timer,attrs:{showData:e.showData,showAddDialog:e.showDrawer,isShowQuery:e.showQuery,tableHeightTab:e.tableHeight},on:{changeStatus:e.changeStatus}}):e._e()],1)])])])],1)]),i("el-dialog",{staticClass:"review-dialog",attrs:{visible:e.dialogNotThroughVisible,title:"未通过原因","close-on-click-modal":!1,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogNotThroughVisible=t}}},[i("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容",disabled:""},model:{value:e.notReason,callback:function(t){e.notReason=t},expression:"notReason"}}),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogNotThroughVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogNotThroughVisible=!1}}},[e._v("确 定")])],1)],1),i("el-dialog",{staticClass:"review-dialog pack-dialog",attrs:{visible:e.dialogPackagingVisible,title:"打包","close-on-click-modal":!1,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogPackagingVisible=t},close:function(t){return e.closeDialogPackaging("packageForm")}}},[i("el-form",{ref:"packageForm",attrs:{model:e.form}},[i("el-form-item",{attrs:{label:"批次包名称","label-width":e.formLabelWidth,prop:"batchGroupName",rules:[{required:!0,message:"请输入批次包名称",trigger:"blur"}]}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.batchGroupName,callback:function(t){e.$set(e.form,"batchGroupName",t)},expression:"form.batchGroupName"}})],1),i("el-form-item",{attrs:{label:"评审方式","label-width":e.formLabelWidth,prop:"auditType",rules:[{required:!0,message:"请选择评审方式",trigger:"change"}]}},[i("el-select",{attrs:{placeholder:"请选择评审方式"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.form.auditType,callback:function(t){e.$set(e.form,"auditType",t)},expression:"form.auditType"}},[i("el-option",{attrs:{label:"在线评审",value:"1"}}),i("el-option",{attrs:{label:"线下评审",value:"0"}})],1)],1),i("el-form-item",{attrs:{label:"评审开始时间","label-width":e.formLabelWidth,prop:"auditStartDate",rules:[{required:!0,message:"请选择选择日期",trigger:"change"}]}},[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd","picker-options":e.pickerOptionsStart1,placeholder:"选择日期"},model:{value:e.form.auditStartDate,callback:function(t){e.$set(e.form,"auditStartDate",t)},expression:"form.auditStartDate"}})],1),i("el-form-item",{attrs:{label:"评审结束时间","label-width":e.formLabelWidth,prop:"auditFinishDate",rules:[{required:!0,message:"请选择选择日期",trigger:"change"}]}},[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions1,placeholder:"选择日期"},model:{value:e.form.auditFinishDate,callback:function(t){e.$set(e.form,"auditFinishDate",t)},expression:"form.auditFinishDate"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){return e.closeDialogPackaging("packageForm")}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",loading:e.packageLoading},on:{click:function(t){return e.SavePackage("packageForm")}}},[e._v("确 定")])],1)],1),i("el-dialog",{staticClass:"review-dialog pack-dialog",attrs:{visible:e.dialogPlanVisible,title:"编辑评审计划","close-on-click-modal":!1,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogPlanVisible=t}}},[i("el-form",{ref:"plan_form",attrs:{model:e.planForm}},[i("el-form-item",{attrs:{label:"项目(包)名称","label-width":e.formLabelWidth}},[i("el-input",{attrs:{disabled:"",autocomplete:"off"},on:{input:function(t){return e.changeInput(t)}},model:{value:e.planForm.batchGroupName,callback:function(t){e.$set(e.planForm,"batchGroupName",t)},expression:"planForm.batchGroupName"}})],1),i("el-form-item",{attrs:{label:"评审方式","label-width":e.formLabelWidth,prop:"auditType",rules:[{required:!0,message:"请选择评审方式",trigger:"change"}]}},[i("el-select",{attrs:{placeholder:"请选择评审方式"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.planForm.auditType,callback:function(t){e.$set(e.planForm,"auditType",t)},expression:"planForm.auditType"}},[i("el-option",{attrs:{label:"在线评审",value:"1"}}),i("el-option",{attrs:{label:"线下评审",value:"0"}})],1)],1),i("el-form-item",{attrs:{label:"评审开始时间","label-width":e.formLabelWidth,prop:"planStartDate",rules:[{required:!0,message:"请选择选择日期",trigger:"change"}]}},[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd","picker-options":e.pickerOptionsStart,placeholder:"选择日期"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.planForm.planStartDate,callback:function(t){e.$set(e.planForm,"planStartDate",t)},expression:"planForm.planStartDate"}})],1),i("el-form-item",{attrs:{label:"评审结束时间","label-width":e.formLabelWidth,prop:"planEndDate",rules:[{required:!0,message:"请选择选择日期",trigger:"change"}]}},[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions,placeholder:"选择日期"},on:{change:function(t){return e.changeInput(t)}},model:{value:e.planForm.planEndDate,callback:function(t){e.$set(e.planForm,"planEndDate",t)},expression:"planForm.planEndDate"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){return e.closeDialogEditPlan("plan_form")}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editPlan("plan_form")}}},[e._v("确 定")])],1)],1),i("el-dialog",{staticClass:" batch_dialog",attrs:{title:"包调整","close-on-click-modal":!1,"custom-class":"cus-dialog",visible:e.dialogPackTrimVisible,"min-width":"800px","before-close":e.handlePackageClose,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogPackTrimVisible=t}}},[i("div",{staticClass:"clearfix batch"},[i("div",{staticClass:"batch_left"},[e.treeList.length?e._e():i("div",{staticStyle:{"text-align":"center"}},[e._v("暂无数据")]),i("ul",{staticClass:"treelist"},e._l(e.treeList,(function(t,a){return i("li",{key:a},[i("el-radio",{attrs:{label:t.id},model:{value:e.packageBatchParam.parentId,callback:function(t){e.$set(e.packageBatchParam,"parentId",t)},expression:"packageBatchParam.parentId"}},[i("el-tooltip",{attrs:{placement:"top"}},[i("span",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.name))]),i("span",[e._v(e._s(e.formatStr(t.name)))])])],1),null!=t.childList&&""!=t.childList?i("span",{staticClass:"iconfont",on:{click:function(t){return e.clicklist(t)}}},[e._v("")]):e._e(),i("el-checkbox-group",{model:{value:e.packageBatchParam.childItemList,callback:function(t){e.$set(e.packageBatchParam,"childItemList",t)},expression:"packageBatchParam.childItemList"}},[i("ul",e._l(t.childList,(function(t,a){return i("li",{key:a},[i("el-checkbox",{attrs:{label:t.id+(t.childList?"1":"0")}},[i("el-tooltip",{attrs:{placement:"top"}},[i("span",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.name))]),i("span",[e._v(e._s(e.formatStr(t.name)))])])],1),null!=t.childList&&""!=t.childList?i("span",{staticClass:"iconfont",on:{click:function(t){return e.clicklist(t)}}},[e._v("")]):e._e(),null!=t.childList&&""!=t.childList?i("ul",e._l(t.childList,(function(a,l){return i("li",{key:l},[i("el-checkbox",{attrs:{label:t.id,disabled:""}},[i("el-tooltip",{attrs:{placement:"top"}},[i("span",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(a.name))]),i("span",[e._v(e._s(e.formatStr(a.name)))])])],1)],1)})),0):e._e()],1)})),0)])],1)})),0)]),i("div",{staticClass:"middle"},[i("img",{attrs:{src:a("3656")},on:{click:e.moveOutPackage}}),i("img",{attrs:{src:a("3075")},on:{click:e.moveInPackage}})]),i("div",{staticClass:"batch_right"},[i("el-table",{ref:"batchPackage",staticStyle:{width:"100%"},attrs:{data:e.singleItemList,border:"","max-height":"300px","min-height":"200px","header-cell-style":{background:"#359691",color:"#fff"},"row-key":e.getSingleItemRowKey,loading:e.singleItemTableLoading,lazy:"",load:e.tableLoadPack,"row-key":"itemId","tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"selection-change":e.handleSingleItemSelectionChange}},[i("el-table-column",{attrs:{type:"selection","reserve-selection":!0,selectable:e.isSelectable,width:"45"}}),e._l(e.tableLabel,(function(t,a){return 1==t.showType&&"itemCont"!=t.colDname&&"questionCode"!=t.colDname?i("el-table-column",{key:a,attrs:{"min-width":"150",prop:t.colDname,label:t.dispName,"show-overflow-tooltip":!0}}):"itemCont"==t.colDname?i("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:t.dispName,"min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.itemCont?[t.row.itemCont.length<10?i("p",[e._v(" "+e._s(t.row.itemCont)+" ")]):i("el-tooltip",{attrs:{placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.row.itemCont))]),i("p",[e._v(e._s(e.formatStr(t.row.itemCont)))])])]:void 0}}],null,!0)}):"questionCode"==t.colDname?i("el-table-column",{attrs:{"min-width":"150",label:t.dispName,"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.questionCode?[t.row.questionCode.length<20?i("p",[e._v(" "+e._s(t.row.questionCode)+" ")]):i("el-tooltip",{attrs:{placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.row.questionCode))]),i("p",[e._v(e._s(e.formatStr(t.row.questionCode)))])])]:void 0}}],null,!0)}):3==t.showType?i("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:t.colDname,label:t.dispName}}):e._e()}))],2),i("div",{staticClass:"page"},[i("el-pagination",{attrs:{background:"","current-page":e.currentSinglePage,"page-sizes":[5,10,15,20],"page-size":5,layout:"sizes, total, prev, pager, next, jumper",total:e.singleItemTotalNum},on:{"size-change":e.handleCurrentPackSizeChange,"current-change":e.handleCurrentPackNumChange}})],1)],1)]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.handlePackageClose}},[e._v("关 闭")])],1)]),i("el-dialog",{attrs:{visible:e.itemShow,"close-on-click-modal":!1,"modal-append-to-body":!1},on:{"update:visible":function(t){e.itemShow=t}}},[i("item-dialog",{attrs:{itemId:e.tempItemId}})],1)],1)},s=[],o=(a("4160"),a("b0c0"),a("4ec9"),a("4fad"),a("d3b7"),a("ac1f"),a("3ca3"),a("1276"),a("159b"),a("ddb0"),a("3835")),n=a("5530"),r=a("ade3"),c=a("73fc"),u=a("a960"),d=a("2bb5"),m=a("c2b4"),h=a("7e1e"),p=a("f36f"),g=a("2f62"),b={name:"planSummary",data:function(){var e;return e={queryBatch:"",queryBatchMode:"",packageLoading:!1,notReason:"",isBatchSearch:!1,searchBatchId:"",param:{itemName:"",createOrg:"",batchId:"",planStatus:"",speciality:"",pageIndex:1,pageSize:20,queryType:1},planStatusList:[{codeValue:1,codeName:"未提交"},{codeValue:2,codeName:"已提交"},{codeValue:3,codeName:"未通过"},{codeValue:4,codeName:"已通过"}],selectParamDict:new Map,isBatch:!1,createOrg:"",form:{batchGroupName:"",auditType:"",auditStartDate:"",auditFinishDate:""},planForm:{batchGroupName:"",auditType:"",planStartDate:"",planEndDate:""},pickerOptions:{disabledDate:this.disabledDate},pickerOptionsStart:{disabledDate:this.disabledDateStart},pickerOptions1:{disabledDate:this.disabledDate1},pickerOptionsStart1:{disabledDate:this.disabledDateStart1},planParam:{itemId:"",auditPlanId:"",auditType:"",planStartDate:"",planEndDate:"",isBatchPackage:""},dialogPackTrimVisible:!1,singleItemList:[],packageBatchParam:{parentId:"",childItemList:[]},treeList:[],currentSinglePage:1,currentSingleNum:5,moveInPackageIds:[],singleItemTotalNum:0,singleItemTableLoading:!1,testData:{name:123,nums:123},dialogPlanVisible:!1,dialogNotThroughVisible:!1,dialogPackagingVisible:!1,dialogPackageVisible:!1,isShowQuery:!1,showQuery:!1,tableHeightTab:"",timer:"",showAddDialog:!1,showData:{itemId:null,specClass:"",specClassName:"",oldPath:"",tableLabelArr:"",phash:"1",parentItemId:null},showDrawer:!1,dialogReviewVisible:!1,dialogLoading:!1,loading:!1,delData:{ids:[]},lableList:[{value:""}],totalNum:0,currentPage:1,currentNum:20,year:"",dialogFormVisible:!1,dialogFormVisible2:!1},Object(r["a"])(e,"form",{time1:"",time2:""}),Object(r["a"])(e,"options",[]),Object(r["a"])(e,"value",""),Object(r["a"])(e,"formLabelWidth","120px"),Object(r["a"])(e,"input",""),Object(r["a"])(e,"colTimeList",[]),Object(r["a"])(e,"tableData",[]),Object(r["a"])(e,"tableLabel",[]),Object(r["a"])(e,"tableDataShow",[]),Object(r["a"])(e,"selectPlanId",{}),Object(r["a"])(e,"columnTypeMap",new Map),Object(r["a"])(e,"tempItemId",""),Object(r["a"])(e,"itemShow",!1),Object(r["a"])(e,"currentColTime",""),Object(r["a"])(e,"curItemName",""),Object(r["a"])(e,"showUpdatePlaneTime",!1),Object(r["a"])(e,"updateForm",{planStartDate:"",planEndDate:""}),Object(r["a"])(e,"timeListloading",!1),Object(r["a"])(e,"tableDataLoading",!1),Object(r["a"])(e,"fileList",[]),Object(r["a"])(e,"tableHeight",""),Object(r["a"])(e,"userId",""),Object(r["a"])(e,"token",""),Object(r["a"])(e,"ParamTemp",{batchId:"",batch:"",speciality:"",itemCreateOrg:"",planStatus:""}),e},components:{"item-dialog":d["default"],ItemAddCom:m["default"],querys:c["a"],SelectTree:u["a"]},created:function(){this.tableHeight=window.innerHeight-235},mounted:function(){this.getColTimeList(),this.getItemLabel(),this.userId=sessionStorage.getItem("userId"),this.token=sessionStorage.getItem("token")},computed:Object(n["a"])({},Object(g["b"])([])),watch:{createOrg:function(){this.param.createOrg=this.createOrg,this.currentPage=1,this.selectBatch()}},methods:(i={tableRowClassName:function(e){var t=e.row;e.rowIndex;return"未通过"==t.auditPlanStatus?"success-row":""},getRowKey:function(e){return e.itemId+Math.random()},changeInput:function(){this.$forceUpdate()},selectBatch:function(){this.ParamTemp={batchId:this.queryBatch,batchName:this.queryBatchMode,speciality:this.param.speciality,itemCreateOrg:this.param.createOrg,planStatus:this.param.planStatus,itemName:this.param.itemName},console.log("temptemptemptemp",this.ParamTemp),this.getColTimeList(this.ParamTemp)},disabledDate:function(e){var t=this;return e<Date.parse(new Date(t.planForm.planStartDate))},disabledDateStart:function(e){var t=this;return e>Date.parse(new Date(t.planForm.planEndDate))},disabledDate1:function(e){var t=this;return!!t.form.auditStartDate&&e<Date.parse(new Date(t.form.auditStartDate))},disabledDateStart1:function(e){var t=this;return console.log(t.form.auditFinishDate),!!t.form.auditFinishDate&&e>Date.parse(new Date(t.form.auditFinishDate))},selectItem:function(e){var t=this;if(e&&""!=t.searchBatchId){var a=0;t.colTimeList.forEach((function(e){if(e.batchId==t.searchBatchId)return a=e.index,t.tableScrollMove("tableLeft",a),!1})),t.$refs.tableLeft.setCurrentRow(t.colTimeList[a],!0)}else t.getTable(t.currentPage,t.currentNum,t.currentColTime.batchId)},getValue:function(e){this.createOrg=e,console.log("createOrg"+e)},getItemLabel:function(){var e=this;Object(h["Vc"])().then((function(t){if(console.log("response",t),t.data.successful){var a=t.data.resultValue;e.selectParamDict.set("speciality",a.specialityList),e.$forceUpdate()}}))},showReasonDialog:function(e){var t=this,a={itemId:e.itemId,isBatchPackage:1==e.isBatchPackage};Object(h["lb"])(a).then((function(e){e.data.successful&&(t.notReason=e.data.resultValue)})),this.dialogNotThroughVisible=!0},resetForm:function(e){this.$refs[e].resetFields()},closeDialogEditPlan:function(e){this.dialogPlanVisible=!1,this.resetForm(e)},closeDialogPackaging:function(e){this.dialogPackagingVisible=!1,this.resetForm(e)},SavePackage:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var a=[];t.selectData&&t.selectData.forEach((function(e){var t={itemId:"",auditPlanId:""};t.itemId=e.itemId,t.auditPlanId=e.auditPlanId,a.push(t)}));var i={batchId:t.currentColTime.batchId,batchGroupName:t.form.batchGroupName,auditType:t.form.auditType,auditStartDate:t.form.auditStartDate,auditFinishDate:t.form.auditFinishDate,itemInfo:a};t.packageLoading=!0,Object(h["l"])(i).then((function(e){t.packageLoading=!1,e.data.successful&&(t.dialogPackagingVisible=!1,t.$refs.singleTable.clearSelection(),t.getTable(t.currentPage,t.currentNum,t.currentColTime.batchId))}))}))},showDialogPackaging:function(){if(""==this.selectData||null==this.selectData||void 0==this.selectData)return this.$message({showClose:!0,message:"请选择批次",type:"warning"}),!1;for(var e=0;e<this.selectData.length;e++){if("已通过"==this.selectData[e].auditPlanStatus||"已提交"==this.selectData[e].auditPlanStatus)return this.$message({showClose:!0,message:"所选项目中不能包含已通过或者已提交状态的项目，请重新选择",type:"warning"}),!1;if(1==this.selectData[e].isBatchPackage)return this.$message({showClose:!0,message:"所选项目中不能包含批次包，请重新选择",type:"warning"}),!1}this.dialogPackagingVisible=!0},isSelectable:function(e){return!e.isChild},editPlan:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.planParam.auditType=t.planForm.auditType,t.planParam.planStartDate=t.planForm.planStartDate,t.planParam.planEndDate=t.planForm.planEndDate,Object(h["K"])(t.planParam).then((function(e){e.data.successful&&(t.dialogPlanVisible=!1,t.$refs.singleTable.clearSelection(),t.getTable(t.currentPage,t.currentNum,t.currentColTime.batchId))})))}))},showDialogPlan:function(e){this.planForm.batchGroupName=e.itemName,this.planForm.planStartDate=e.planStartDate,this.planForm.planEndDate=e.planEndDate,this.planForm.auditType=e.auditType,this.planParam.itemId=e.itemId,this.planParam.auditPlanId=e.auditPlanId,1==e.isBatchPackage?this.planParam.isBatchPackage=!0:this.planParam.isBatchPackage=!1,this.dialogPlanVisible=!0},showBatchPackage:function(){var e=this;e.getTreeList(),e.currentSinglePage=1,e.getPackageItem(1,5)},getTreeList:function(){var e=this,t=this;Object(h["eb"])({batchId:t.currentColTime.batchId}).then((function(a){a.data.successful?(console.log(a),t.treeList=a.data.resultValue,t.dialogPackTrimVisible=!0):e.$message.error("查询树形关系列表失败")}))},getPackageItem:function(e,t){var a=this,i=this;i.singleItemTableLoading=!0,Object(h["Nb"])({batchId:i.currentColTime.batchId,pageIndex:e,pageSize:t}).then((function(e){if(e.data.successful){i.singleItemTotalNum=e.data.resultValue.totalNum;var t=e.data.resultValue.tableData;i.singleItemList=i.getShowDateTable(t,i.dictMap,i.columnTypeMap),i.dialogPackTrimVisible=!0}else a.$message.error("查询项目列表失败")}))},tableLoadPack:function(e,t,a){var i=this,l={parentItemId:e.itemId};Object(h["nb"])(l).then((function(e){if(e.data.successful){var t=e.data.resultValue,l=i.getShowDateTable(t,i.dictMap,i.columnTypeMap);l.forEach((function(e){e.isChild=!0})),i.$forceUpdate(),console.log(l),a(l)}}))}},Object(r["a"])(i,"isSelectable",(function(e){return!e.isChild})),Object(r["a"])(i,"handleCurrentPackSizeChange",(function(e){this.currentSingleNum=e,this.getPackageItem(this.currentSinglePage,e)})),Object(r["a"])(i,"handleCurrentPackNumChange",(function(e){this.currentSinglePage=e,this.getPackageItem(e,this.currentSingleNum)})),Object(r["a"])(i,"handlePackageClose",(function(){this.dialogPackTrimVisible=!1,this.currentPage=1,this.getTable(1,this.currentNum,this.currentColTime.batchId)})),Object(r["a"])(i,"handleSingleItemSelectionChange",(function(e){var t=this;t.moveInPackageArr=[],e.forEach((function(e){var a={itemId:"",hasChildren:""};a.itemId=e.itemId,a.hasChildren=e.hasChildren,t.moveInPackageArr.push(a)}))})),Object(r["a"])(i,"getSingleItemRowKey",(function(e){return e.itemId})),Object(r["a"])(i,"clicklist",(function(e){var t=e.target.nextSibling;""!=t.style.display?t.style.display="":t.style.display="none"})),Object(r["a"])(i,"moveOutPackage",(function(){var e=this,t=this,a=[];if(0==t.packageBatchParam.childItemList.length)return this.$message({showClose:!0,message:"请选择要移出的项目",type:"warning"}),!1;var i=t.packageBatchParam.childItemList;i.forEach((function(e){var t={itemId:"",hasChildren:""};t.itemId=e.substring(0,e.length-1),t.hasChildren=e.substr(e.length-1),a.push(t)})),Object(h["Cd"])(a).then((function(a){a.data.successful?(e.$message.success("移出项目包成功"),t.packageBatchParam.childItemList=[],t.showBatchPackage()):e.$message.error("移出项目包失败")}))})),Object(r["a"])(i,"moveInPackage",(function(){var e=this,t=this;if(""==t.packageBatchParam.parentId)return this.$message({showClose:!0,message:"请选择要移入的批次包",type:"warning"}),!1;if(0==t.moveInPackageArr.length)return this.$message({showClose:!0,message:"请选择要移入的项目",type:"warning"}),!1;var a=[];t.moveInPackageArr.forEach((function(e){var i={};i.itemId=e.itemId,i.hasChildren=e.hasChildren,i.batchGroupId=t.packageBatchParam.parentId,a.push(i)})),Object(h["Ad"])(a).then((function(a){a.data.successful?(t.$refs.batchPackage.clearSelection(),t.moveInPackageArr=[],t.$message.success("移入项目包成功"),t.showBatchPackage()):e.$message.error("移入项目包失败")}))})),Object(r["a"])(i,"formatStr",(function(e){return e.length<10?e:e.substring(0,10)+"..."})),Object(r["a"])(i,"changeStatus",(function(e){this.showDrawer=e,console.log("status"+e)})),Object(r["a"])(i,"tableLoad",(function(e,t,a){var i=this;if(console.log(e.batchGroupId),""!=e.batchGroupId&&void 0!=e.batchGroupId){var l={batchGroupId:e.batchGroupId};Object(h["cb"])(l).then((function(e){if(e.data.successful){var t=e.data.resultValue,l=i.getShowDateTable(t,i.dictMap,i.columnTypeMap);l.forEach((function(e){e.isChild=!0,e.isEdit=!1})),console.log(l),a(l)}}))}else if(e.children&&0!=e.children.length){console.log(e.children);var s=this.getShowDateTable(e.children,this.dictMap,this.columnTypeMap);s.forEach((function(e){e.isChild=!0,e.isEdit=!1})),a(s)}else{var o={parentItemId:e.itemId};Object(h["nb"])(o).then((function(e){if(e.data.successful){var t=e.data.resultValue,l=i.getShowDateTable(t,i.dictMap,i.columnTypeMap);l.forEach((function(e){e.isChild=!0,e.isEdit=!1})),i.$forceUpdate(),console.log(l),a(l)}}))}})),Object(r["a"])(i,"showDetailDialog",(function(e){this.showData.itemId=e.itemId,this.showData.phash=0,this.showDrawer=!0,this.timer=(new Date).getTime()})),Object(r["a"])(i,"submitAssessment",(function(){var e=this,t=this;new FormData;if(""==t.currentColTime||null==t.currentColTime)return this.$message({showClose:!0,message:"请选择时间批次",type:"warning"}),!1;if(""==t.selectData||null==t.selectData||void 0==t.selectData)return this.$message({showClose:!0,message:"请选择项目",type:"warning"}),!1;for(var a=0;a<t.selectData.length;a++){if("未通过"==t.selectData[a].auditPlanStatus)return this.$message({showClose:!0,message:"不能再次提交可研评审计划编制评审退回的项目，请在待办中操作",type:"warning"}),!1;if("已通过"==t.selectData[a].auditPlanStatus||"已提交"==t.selectData[a].auditPlanStatus)return this.$message({showClose:!0,message:"所选项目中包含已通过或者已提交状态的项目，请重新选择",type:"warning"}),!1}this.$confirm("是否提交评审计划?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){0==e.$store.state.user.workflowtype&&function(){var t="",a=window.JSON.parse(sessionStorage.getItem("iscOrg")),i=window.JSON.parse(sessionStorage.getItem("specRoleMap")),l=window.JSON.parse(sessionStorage.getItem("purchaseRoleMap")),s=window.JSON.parse(sessionStorage.getItem("electronicRoleMap")),o=sessionStorage.getItem("userId"),n={user:o,orgIds:a.id,roleIds:t,processDefName:"plan_review",activityDefID:"KYJHBZSP",processInstName:"",processInstDesc:"",itemId:""},r=function(a){var r=e.selectData[a];t=i[r.specialityT],n.roleIds=t,"01"==r.specialityT&&(t=s[r.specDetailClassT],n.roleIds=t),"08"==r.specialityT&&(t=l[r.specClassT],n.roleIds=t),n.itemId=r.itemId,n.processInstName=r.itemName+"-可研评审计划编制评审",n.processInstDesc=r.itemName+"-可研评审计划编制评审",void 0==n.orgIds&&(n.orgIds=""),void 0==n.roleIds&&(n.roleIds=""),Object(p["c"])(n).then((function(t){if(0==t.data.status){var a={processInstID:t.data.data,userId:o,itemId:r.itemId,type:""};""!=r.batchGroupId&&void 0!=r.batchGroupId&&null!=r.batchGroupId?a.isBatchPackage=!0:a.isBatchPackage=!1,Object(h["v"])(a).then((function(t){if(t.data.successful){var i={processInstID:a.processInstID,itemId:r.itemId,userId:o,isAudit:"",workItemId:"123",auditDesc:"评审计划编制",itemPhaseDet:"7"};""!=r.batchGroupId&&void 0!=r.batchGroupId&&null!=r.batchGroupId?i.isBatchPackage=!0:i.isBatchPackage=!1,Object(h["sd"])(i).then((function(a){if(t.data.successful){var l={itemId:r.itemId,isBatchPackage:i.isBatchPackage,status:2};Object(h["Qd"])(l).then((function(t){t.data.successful&&(e.$refs.singleTable.clearSelection(),e.$message.success("提交评审计划编制成功"),e.getTable(e.currentPage,e.currentNum,e.currentColTime.batchId))}))}else{var s=t.data.resultHint;e.$message.error(r.itemName+s)}}))}else{var l=t.data.resultHint;e.$message.error(r.itemName+l)}}))}else e.$message.error(r.itemName+t.data.message)}))};for(var c in e.selectData)r(c)}()}))})),Object(r["a"])(i,"formartDate",(function(e){var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1,l=t.getDate();return a+"-"+this.add0(i)+"-"+this.add0(l)})),Object(r["a"])(i,"add0",(function(e){return e<10?"0"+e:e})),Object(r["a"])(i,"handleChangeColTimeList",(function(e){var t=this;t.currentColTime!=e&&(t.currentColTime=e,this.$refs.singleTable.clearSelection(),t.getTable(t.currentPage,t.currentNum,t.currentColTime.batchId),t.queryBatch=e)})),Object(r["a"])(i,"getColTimeList",(function(e){var t=this,a=this;a.timeListloading=!0,console.log(e),Object(h["db"])(e).then((function(e){if(console.log(e),a.timeListloading=!1,e.data.successful){var i=e.data.resultValue;a.colTimeList=[];for(var l=0;l<i.length;l++){var s={};s.batchName=i[l].batchName,s.batchId=i[l].batchId,s.index=l,a.colTimeList.push(s)}i.length>0?(a.currentColTime=i[0],a.$refs.tableLeft.setCurrentRow(a.colTimeList[0],!0),a.queryBatch=a.colTimeList[0].batchId):a.tableDataShow=[]}else t.$message({showClose:!0,message:"获取评审计划信息列表失败",type:"error"})}))})),Object(r["a"])(i,"showItemInfo",(function(e){var t=this;t.tempItemId=e.itemId,this.$router.push({path:"/itemInfo",query:{itemId:t.tempItemId,oldPath:t.$route.path}})})),Object(r["a"])(i,"handleSelectionChange",(function(e){var t=this;t.selectData=[],e.forEach((function(e){t.selectData.push(e)}))})),Object(r["a"])(i,"handleSizeChange",(function(e){this.currentNum=e,this.getTable(this.currentPage,e,this.currentColTime.batchId)})),Object(r["a"])(i,"handleCurrentChange",(function(e){console.log("当前页: ".concat(e)),this.currentPage=e,this.getTable(e,this.currentNum,this.currentColTime.batchId)})),Object(r["a"])(i,"tableScrollMove",(function(e,t){if(e&&this.$refs[e]){var a=this.$refs[e].$el;if(a){var i=a.querySelectorAll(".el-table__body tr")[t].getBoundingClientRect().top,l=a.querySelector(".el-table__body").getBoundingClientRect().top,s=a.querySelector(".el-table__body-wrapper");s.scrollTop=i-l}}})),Object(r["a"])(i,"getTable",(function(e,t,a){var i=this;i.tableDataLoading=!0,i.loading=!0,i.param.pageIndex=e,i.param.pageSize=t,i.param.batchId=a,Object(h["Xc"])().then((function(e){i.tableDataLoading=!1,console.log("response",e),e.data.successful&&(i.tableLabel=e.data.resultValue,i.dictMap=i.getDictArr(i.tableLabel),i.columnTypeMap=i.getColumnTypeArr(i.tableLabel),Object(h["Ec"])(i.param).then((function(e){console.log("planHookUp",e),i.loading=!1,e.data.successful&&(i.totalNum=e.data.resultValue.totalNum,i.tableData=e.data.resultValue.tableData,i.tableDataShow=i.getShowDateTable(i.tableData,i.dictMap,i.columnTypeMap))})))})).catch((function(e){console.log(e)}))})),Object(r["a"])(i,"getDictArr",(function(e){for(var t=new Map,a=0;a<e.length;a++){var i=e[a];null!=i.codeList&&t.set(i.colDname,i.codeList)}return t})),Object(r["a"])(i,"getColumnTypeArr",(function(e){for(var t=new Map,a=0;a<e.length;a++){var i=e[a];t.set(i.colDname,i.colType)}return t})),Object(r["a"])(i,"getLabelList",(function(e){var t=this;e.forEach((function(e){t.$set(e,"value","")}));var a={};for(var i in e)a[i]=e[i];return a})),Object(r["a"])(i,"getShowDateTable",(function(e,t,a){for(var i=this,l=[],s=0;s<e.length;s++){var n=e[s];""!=n.batchId&&void 0!=n.batchId?this.isBatch=!0:this.isBatch=!1;for(var r=new Object,c=0,u=Object.entries(n);c<u.length;c++){var d=Object(o["a"])(u[c],2),m=d[0],h=d[1];if(t.has(m)){for(var p=t.get(m),g=0;g<p.length;g++){var b=p[g];b.codeValue==h&&(r[m]=b.codeName)}r[m]||(r[m]=h)}else if("date"==a.get(m)&&h){r[m+"Rel"]=h;var f=i.formartDate(h);r[m]=f}else r[m]=h}l.push(r)}return l})),Object(r["a"])(i,"beforeUploadReport",(function(e){if(e.name){var t=e.name.split(".")[1];return"doc"==t||"docx"==t||(this.$message.warning("文件格式不正确,只能上传doc,docx文件!"),!1)}return this.$message.warning("文件格式不正确,只能上传doc,docx文件!"),!1})),i)},f=b,v=(a("84fe"),a("a91f"),a("2877")),w=Object(v["a"])(f,l,s,!1,null,"09f82df1",null);t["default"]=w.exports},"5e60":function(e,t,a){},"84fe":function(e,t,a){"use strict";var i=a("5e60"),l=a.n(i);l.a},a91f:function(e,t,a){"use strict";var i=a("be17"),l=a.n(i);l.a},be17:function(e,t,a){}}]);
//# sourceMappingURL=chunk-0f651f2e.e794b19f.js.map