(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fe9ce984"],{"1ef9":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"main clearfix",style:{"margin-left":e.$store.state.app.isCollapse?"84px":"240px"}},[a("div",{staticClass:"main_container"},[a("querys",{attrs:{showSwitch:!1}},[a("div",{attrs:{slot:"queryTabs"},slot:"queryTabs"},[a("div",{staticClass:"query_tab"},[a("div",{staticClass:"query_label"},[e._v("项目名称")]),a("div",{staticClass:"query_select"},[a("el-input",{attrs:{size:"small",placeholder:"请输入关键词"},on:{change:function(t){return e.selectItem()}},model:{value:e.param.itemName,callback:function(t){e.$set(e.param,"itemName",t)},expression:"param.itemName"}})],1)]),a("div",{staticClass:"query_tab"},[a("div",{staticClass:"query_label"},[e._v("所属单位")]),a("div",{staticClass:"query_select"},[a("select-tree",{on:{getValue:e.getValue}})],1)]),a("div",{staticClass:"query_tab"},[a("div",{staticClass:"query_label"},[e._v("批次名称")]),a("div",{staticClass:"query_select"},[a("el-input",{attrs:{type:"text",clearable:"",size:"small",placeholder:"请输入"},on:{change:function(t){return e.selectItem()}},model:{value:e.param.batchName,callback:function(t){e.$set(e.param,"batchName",t)},expression:"param.batchName"}})],1)]),a("div",{staticClass:"query_tab"},[a("div",{staticClass:"query_label"},[e._v("专业类别")]),a("div",{staticClass:"query_select"},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",size:"small"},on:{change:function(t){return e.selectItem()}},model:{value:e.param.speciality,callback:function(t){e.$set(e.param,"speciality",t)},expression:"param.speciality"}},e._l(e.selectParamDict.get("speciality"),(function(e){return a("el-option",{key:e.codeValue,attrs:{label:e.codeName,value:e.codeValue}})})),1)],1)])])]),a("div",{staticClass:"template_main"},[a("div",{staticClass:"table-item-box"},[a("div",{class:e.showDrawer?"table-wrapper-run":"table-wrapper-init"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableDataLoading,expression:"tableDataLoading"}],attrs:{data:e.tableDataShow,height:e.tableHeight,border:"","header-cell-style":{background:"#359691",color:"#fff"},"row-class-name":"row","cell-class-name":"column",lazy:"",load:e.tableLoad,"row-key":"itemId","tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),e._l(e.tableLabel,(function(t,l){return"itemName"!=t.colDname&&1==t.showType?a("el-table-column",{key:l,attrs:{prop:t.colDname,label:t.dispName,"min-width":"220","show-overflow-tooltip":!0}}):"itemName"==t.colDname?a("el-table-column",{attrs:{label:t.dispName,width:"200","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.isBatchPackage?a("span",[e._v(e._s(t.row.itemName))]):a("span",{staticClass:"blue",on:{click:function(a){return e.showDetailDialog(t.row)}}},[e._v(e._s(t.row.itemName))])]}}])}):e._e()}))],2),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":20,"page-sizes":[10,20,30,50],layout:"sizes, total, prev, pager, next, jumper",total:e.totalNum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("div",{staticClass:"planDrawer",class:e.showDrawer?"item-add-wrapper-run":"item-wrapper-init"},[e.showDrawer?a("item-add-com",{key:e.timer,attrs:{showData:e.showData,showAddDialog:e.showDrawer,isShowQuery:e.showQuery,tableHeightTab:e.tableHeight},on:{changeStatus:e.changeStatus}}):e._e()],1)])])],1)]),a("el-dialog",{attrs:{visible:e.itemShow,"close-on-click-modal":!1,"modal-append-to-body":!1},on:{"update:visible":function(t){e.itemShow=t}}},[a("item-dialog",{attrs:{itemId:e.tempItemId}})],1)],1)},i=[],s=(a("4160"),a("4ec9"),a("4fad"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("3835")),n=a("5530"),r=a("73fc"),o=a("a960"),c=a("2bb5"),u=a("c2b4"),d=a("7e1e"),h=a("2f62"),m={name:"planSummary",data:function(){return{queryBatch:"",queryBatchMode:"",selectParamDict:new Map,radio:1,planAdvice:"",isShowQuery:!1,showQuery:!1,tableHeightTab:"",timer:"",showAddDialog:!1,showData:{itemId:null,specClass:"",specClassName:"",oldPath:"",tableLabelArr:"",phash:"1",parentItemId:null},showDrawer:!1,dialogReviewVisible:!1,dialogLoading:!1,loading:!1,delData:{ids:[]},lableList:[{value:""}],totalNum:0,currentPage:1,currentNum:20,year:"",dialogFormVisible:!1,dialogFormVisible2:!1,form:{time1:"",time2:""},options:[],value:"",formLabelWidth:"120px",input:"",colTimeList:[],tableData:[],tableLabel:[],tableDataShow:[],selectPlanId:{},columnTypeMap:new Map,param:{itemPhaseDet:"7",queryType:1,batchName:"",itemName:"",speciality:"",pageIndex:1,pageSize:20,createOrg:""},tempItemId:"",itemShow:!1,currentColTime:"",curItemName:"",showUpdatePlaneTime:!1,updateForm:{planStartDate:"",planEndDate:""},auditPlanId:"",timeListloading:!1,tableDataLoading:!1,advice:{agreeType:"2",checkAdvice:""},fileList:[],tableHeight:"",userId:"",token:"",createOrg:""}},components:{"item-dialog":c["default"],ItemAddCom:u["default"],querys:r["a"],SelectTree:o["a"]},created:function(){this.tableHeight=window.innerHeight-190},mounted:function(){this.getTable(1,20),this.getItemLabelSearch(),this.userId=sessionStorage.getItem("userId"),this.token=sessionStorage.getItem("token")},computed:Object(n["a"])({},Object(h["b"])([])),watch:{createOrg:function(){this.param.createOrg=this.createOrg,this.currentPage=1,this.getTable(1,this.currentNum)}},methods:{getValue:function(e){this.createOrg=e,console.log("createOrg"+e)},selectItem:function(){this.currentPage=1,this.getTable(1,this.currentNum)},changeStatus:function(e){this.showDrawer=e,console.log("status"+e)},tableLoad:function(e,t,a){var l=this;if(console.log(e.batchGroupId),""!=e.batchGroupId&&void 0!=e.batchGroupId){var i={batchGroupId:e.batchGroupId};Object(d["cb"])(i).then((function(e){if(e.data.successful){var t=e.data.resultValue,i=l.getShowDateTable(t,l.dictMap,l.columnTypeMap);a(i)}}))}else if(e.children&&0!=e.children.length){console.log(e.children);var s=this.getShowDateTable(e.children,this.dictMap,this.columnTypeMap);a(s)}else{var n={parentItemId:e.itemId};Object(d["nb"])(n).then((function(e){if(e.data.successful){var t=e.data.resultValue,i=l.getShowDateTable(t,l.dictMap,l.columnTypeMap);a(i)}}))}},showDetailDialog:function(e){this.showData.itemId=e.itemId,this.showData.phash=0,this.showDrawer=!0,this.timer=(new Date).getTime()},showReviewDia:function(){this.planAdvice="",this.radio=1,this.dialogReviewVisible=!0},getItemLabelSearch:function(){var e=this;Object(d["Vc"])().then((function(t){if(console.log("response",t),t.data.successful){var a=t.data.resultValue;e.selectParamDict.set("speciality",a.specialityList),e.$forceUpdate()}}))},submitPlanReview:function(){var e=this,t=[];this.selectPlanArr.forEach((function(e){var a=e.hasPackage,l={itemId:e.itemId,checkType:this.radio,checkAdvice:this.planAdvice,hasPackage:a};t.push(l)})),Object(d["p"])(t).then((function(t){t.data.successful?e.$message.success("审查成功"):e.$message.error("审查失败")}))},formartDate:function(e){var t=new Date(e),a=t.getFullYear(),l=t.getMonth()+1,i=t.getDate();return a+"-"+this.add0(l)+"-"+this.add0(i)},add0:function(e){return e<10?"0"+e:e},showItemInfo:function(e){var t=this;t.tempItemId=e.itemId,this.$router.push({path:"/itemInfo",query:{itemId:t.tempItemId,oldPath:t.$route.path}})},handleSelectionChange:function(e){var t=this;t.selectPlanArr=[],e.forEach((function(e){t.selectPlanArr.push(e)}))},handleSizeChange:function(e){this.currentNum=e,this.getTable(this.currentPage,e)},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.currentPage=e,this.getTable(e,this.currentNum)},getTable:function(e,t){var a=this;a.tableDataLoading=!0,a.loading=!0,a.param.pageIndex=e,a.param.pageSize=t,Object(d["Xc"])().then((function(e){a.tableDataLoading=!1,console.log("response",e),e.data.successful&&(a.tableLabel=e.data.resultValue,a.dictMap=a.getDictArr(a.tableLabel),a.columnTypeMap=a.getColumnTypeArr(a.tableLabel),Object(d["Ec"])(a.param).then((function(e){console.log("planHookUp",e),a.loading=!1,e.data.successful&&(a.totalNum=e.data.resultValue.totalNum,a.tableData=e.data.resultValue.tableData,a.tableDataShow=a.getShowDateTable(a.tableData,a.dictMap,a.columnTypeMap))})))})).catch((function(e){console.log(e)}))},getDictArr:function(e){for(var t=new Map,a=0;a<e.length;a++){var l=e[a];null!=l.codeList&&t.set(l.colDname,l.codeList)}return t},getColumnTypeArr:function(e){for(var t=new Map,a=0;a<e.length;a++){var l=e[a];t.set(l.colDname,l.colType)}return t},getLabelList:function(e){var t=this;e.forEach((function(e){t.$set(e,"value","")}));var a={};for(var l in e)a[l]=e[l];return a},getShowDateTable:function(e,t,a){for(var l=this,i=[],n=0;n<e.length;n++){for(var r=e[n],o=new Object,c=0,u=Object.entries(r);c<u.length;c++){var d=Object(s["a"])(u[c],2),h=d[0],m=d[1];if(console.log(h+":"+m),t.has(h))for(var p=t.get(h),g=0;g<p.length;g++){var b=p[g];b.codeValue==m&&(o[h]=b.codeName)}else if("date"==a.get(h)&&m){o[h+"Rel"]=m;var f=l.formartDate(m);o[h]=f}else o[h]=m}i.push(o)}return i}}},p=m,g=(a("9c04"),a("7030"),a("2877")),b=Object(g["a"])(p,l,i,!1,null,"5635d465",null);t["default"]=b.exports},"64ac":function(e,t,a){},7030:function(e,t,a){"use strict";var l=a("d010f"),i=a.n(l);i.a},"9c04":function(e,t,a){"use strict";var l=a("64ac"),i=a.n(l);i.a},d010f:function(e,t,a){}}]);
//# sourceMappingURL=chunk-fe9ce984.f8842367.js.map