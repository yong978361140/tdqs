(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02d63040"],{8203:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main clearfix",style:{"margin-left":t.$store.state.app.isCollapse?"84px":"240px"}},[a("div",{staticClass:"main_container"},[a("querys",{attrs:{showSwitch:!1}},[a("div",{attrs:{slot:"queryTabs"},slot:"queryTabs"},[a("div",{staticClass:"query_tab"},[a("div",{staticClass:"query_label"},[t._v("专项类别")]),a("div",{staticClass:"query_select"},[void 0!=t.selectParamDict?a("el-select",{attrs:{placeholder:"请选择",size:"small",clearable:""},on:{change:t.selectItem},model:{value:t.param.speciality,callback:function(e){t.$set(t.param,"speciality",e)},expression:"param.speciality"}},t._l(t.selectParamDict.get("speciality"),(function(t){return a("el-option",{key:t.codeValue,attrs:{label:t.codeName,value:t.codeValue}})})),1):t._e()],1)]),a("div",{staticClass:"query_tab"},[a("div",{staticClass:"query_label"},[t._v("批次名称")]),a("div",{staticClass:"query_select"},[a("el-input",{attrs:{type:"text",clearable:"",size:"small",min:"1",placeholder:"请输入"},on:{change:t.selectItem},model:{value:t.param.batchName,callback:function(e){t.$set(t.param,"batchName",e)},expression:"param.batchName"}})],1)]),a("div",{staticClass:"query_tab"},[a("div",{staticClass:"query_label"},[t._v("上报开始")]),a("div",{staticClass:"query_select"},[a("el-date-picker",{staticStyle:{width:"150px!important"},attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"date",size:"small","picker-options":t.pickerOptionsStart,placeholder:"选择日期"},on:{change:t.getTable},model:{value:t.param.reportStartDate,callback:function(e){t.$set(t.param,"reportStartDate",e)},expression:"param.reportStartDate"}})],1)]),a("div",{staticClass:"query_tab"},[a("div",{staticClass:"query_label"},[t._v("上报结束")]),a("div",{staticClass:"query_select"},[a("el-date-picker",{staticStyle:{width:"150px!important"},attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"date",size:"small","picker-options":t.pickerOptions,placeholder:"选择日期"},on:{change:t.getTable},model:{value:t.param.reportFinishDate,callback:function(e){t.$set(t.param,"reportFinishDate",e)},expression:"param.reportFinishDate"}})],1)])]),"评审批次管理"==t.$route.name?a("div",{attrs:{slot:"queryBtns"},slot:"queryBtns"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.showEdit("新增批次",null)}}},[t._v("新增")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.del()}}},[t._v("删除")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.publish()}}},[t._v("发布")])],1):t._e()]),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"itemTable",staticStyle:{width:"100%"},attrs:{data:t.tableShowData,height:t.tableHeight,border:"","header-cell-style":{background:"#359691",color:"#fff"},"cell-class-name":"column","highlight-current-row":!0,"row-key":t.getRowKeys},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",selectable:t.isSelect,width:"45"}}),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),a("el-table-column",{attrs:{prop:"speciality",label:"专项类别",width:"180"}}),a("el-table-column",{attrs:{prop:"batch",label:"批次",width:"100"}}),a("el-table-column",{attrs:{prop:"batchName",label:"批次名称",width:"180"}}),a("el-table-column",{attrs:{prop:"batchCode",label:"批次编号",width:"180"}}),a("el-table-column",{attrs:{prop:"reportStartDate",label:"上报开始时间",width:"180"}}),a("el-table-column",{attrs:{prop:"reportFinishDate",label:"上报截止时间",width:"180"}}),a("el-table-column",{attrs:{prop:"batchStatus",label:"状态",width:"100"}}),a("el-table-column",{attrs:{prop:"auditStartDate",label:"计划评审开始时间",width:"180"}}),a("el-table-column",{attrs:{prop:"auditFinishDate",label:"计划评审开始时间",width:"180"}}),a("el-table-column",{attrs:{prop:"createUserNo",label:"创建人",width:"180"}}),a("el-table-column",{attrs:{prop:"createOrg",label:"创建单位",width:"180"}}),"评审批次管理"==t.$route.name?a("el-table-column",{attrs:{label:"操作","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return["未发布"==e.row.batchStatus?a("span",{staticClass:"blue",on:{click:function(a){return t.showEdit("编辑批次",e.row)}}},[t._v("编辑")]):a("span",{staticClass:"gray"},[t._v("编辑")])]}}],null,!1,465494270)}):t._e()],1),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{background:"","current-page":t.param.pageIndex,"page-sizes":[10,20,30,50],"page-size":20,layout:"sizes, total, prev, pager, next, jumper",total:t.totalNum},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1),a("el-dialog",{attrs:{visible:t.dialogFormVisible,"close-on-click-modal":!1,"custom-class":"review_dialog",title:t.dialogTitle,"modal-append-to-body":!1,width:"900px"},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.closeDialogForm}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px",size:"small",rules:t.rules}},[a("el-form-item",{attrs:{label:"专项类别",prop:"speciality",rules:[{required:!0,message:"请选择专项类别",trigger:"change"}]}},[a("el-select",{attrs:{placeholder:"请选择专项类别"},model:{value:t.form.speciality,callback:function(e){t.$set(t.form,"speciality",e)},expression:"form.speciality"}},t._l(t.selectParamDict.get("speciality"),(function(t){return a("el-option",{key:t.codeValue,attrs:{label:t.codeName,value:t.codeValue}})})),1)],1),a("el-form-item",{attrs:{label:"批次",prop:"batch"}},[a("el-input",{attrs:{type:"number",min:"1",clearable:"",size:"small",placeholder:"请输入"},model:{value:t.form.batch,callback:function(e){t.$set(t.form,"batch","string"===typeof e?e.trim():e)},expression:"form.batch"}})],1),a("el-form-item",{attrs:{label:"批次名称",prop:"batchName",rules:[{required:!0,message:"批次名称不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:t.form.batchName,callback:function(e){t.$set(t.form,"batchName",e)},expression:"form.batchName"}})],1),a("el-form-item",{attrs:{label:"上报开始时间",prop:"reportStartDate",rules:[{required:!0,message:"开始时间不能为空",trigger:"change"}]}},[a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd","picker-options":t.formReportStartDate},model:{value:t.form.reportStartDate,callback:function(e){t.$set(t.form,"reportStartDate",e)},expression:"form.reportStartDate"}})],1),a("el-form-item",{attrs:{label:"上报结束时间",prop:"reportFinishDate",rules:[{required:!0,message:"结束时间不能为空",trigger:"change"}]}},[a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd","picker-options":t.formReportFinishDate},model:{value:t.form.reportFinishDate,callback:function(e){t.$set(t.form,"reportFinishDate",e)},expression:"form.reportFinishDate"}})],1),a("el-form-item",{attrs:{label:"评审开始时间",prop:"auditStartDate",rules:[{required:!0,message:"开始时间不能为空",trigger:"change"}]}},[a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd","picker-options":t.formAuditStartDate},model:{value:t.form.auditStartDate,callback:function(e){t.$set(t.form,"auditStartDate",e)},expression:"form.auditStartDate"}})],1),a("el-form-item",{attrs:{label:"评审结束时间",prop:"auditFinishDate",rules:[{required:!0,message:"结束时间不能为空",trigger:"change"}]}},[a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd","picker-options":t.formAuditFinishDate},model:{value:t.form.auditFinishDate,callback:function(e){t.$set(t.form,"auditFinishDate",e)},expression:"form.auditFinishDate"}})],1),a("el-form-item",{attrs:{align:"right"}},[a("el-button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:function(e){return t.submitForm("form")}}},[t._v("确定")]),a("el-button",{on:{click:t.closeDialogForm}},[t._v("取消")])],1)],1)],1)],1)},i=[],s=(a("4160"),a("a15b"),a("b0c0"),a("4ec9"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("5530")),l=a("ade3"),o=a("2f62"),n=(a("2bb5"),a("a960")),c=a("c2b4"),u=a("7e1e"),d=a("73fc"),p={name:"reviewBatch",data:function(){var t;return t={rules:{batch:[{required:!0,message:"请输入批次",trigger:"blur"},{pattern:/^\+?[1-9]\d*$/,message:"请输入大于0的整数",trigger:"blur"}]},submitLoading:!1,batchIds:[],form:{reportStartDate:"",reportFinishDate:"",auditStartDate:"",auditFinishDate:"",batchName:"",batch:"",speciality:""},dialogFormVisible:!1,dialogTitle:"",formReportStartDate:{disabledDate:this.disabledReportStartDate},formReportFinishDate:{disabledDate:this.disabledReportFinishDate},formAuditStartDate:{disabledDate:this.disabledAuditStartDate},formAuditFinishDate:{disabledDate:this.disabledAuditFinishDate},pickerOptions:{disabledDate:this.disabledDate},pickerOptionsStart:{disabledDate:this.disabledDateStart},tableData:[],tableShowData:[],tableLoading:!1,totalNum:0,param:{pageIndex:1,queryType:"1",pageSize:20,speciality:"",reportStartDate:"",reportFinishDate:"",batchStatus:"",batchName:""},selectParamDict:new Map},Object(l["a"])(t,"batchIds",[]),Object(l["a"])(t,"delArr",[]),Object(l["a"])(t,"userId",""),Object(l["a"])(t,"token",""),t},components:{querys:d["a"],SelectTree:n["a"],ItemAddCom:c["default"]},created:function(){this.tableHeight=window.innerHeight-220},mounted:function(){var t=this;t.getItemLabel(),t.userId=sessionStorage.getItem("userId"),t.token=sessionStorage.getItem("token"),"评审批次查询"==t.$route.name?(t.param.batchStatus="1",t.param.queryType="2"):(t.param.batchStatus="",t.param.queryType="1")},computed:Object(s["a"])({},Object(o["b"])([])),watch:{$route:{handler:function(t,e){console.log(t.name),this.param={pageIndex:1,pageSize:20,speciality:"",reportStartDate:"",reportFinishDate:"",batchStatus:"",queryType:"1",batchName:""},"评审批次查询"==t.name?(this.param.batchStatus="1",this.param.queryType="2",this.getTable()):(this.param.batchStatus="",this.param.queryType="1",this.getTable())}}},methods:{isSelect:function(t){return"已发布"!=t.batchStatus},cannclSelection:function(){this.$refs.itemTable.clearSelection()},publish:function(){var t=this;this.batchIds.length?Object(u["Lc"])({batchIds:this.batchIds.join(",")}).then((function(e){e.data.successful&&(t.$message({showClose:!0,message:"发布成功",type:"success"}),t.cannclSelection(),t.getTable())})):this.$message({showClose:!0,message:"请选择要发布的数据",type:"warning"})},del:function(){var t=this;if(!t.delArr.length)return t.$message({showClose:!0,message:"请选择要删除的数据",type:"warning"}),!1;for(var e=0;e<t.delArr.length;e++){var a=t.delArr[e];if(a.createUserNoT!=t.userId)return t.$message({showClose:!0,message:"所选项目中含有不是创建者创建的批次，请检查后再删除",type:"warning"}),!1}t.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["Jc"])({batchIds:t.batchIds.join(",")}).then((function(e){console.log(e),e.data.successful&&(t.$message({showClose:!0,message:"删除成功",type:"success"}),t.getTable())}))})).catch((function(){t.$message({type:"warning",message:"已取消删除"})}))},handleSelectionChange:function(t){var e=this;e.delArr=[],e.batchIds=[],t.forEach((function(t,a){e.delArr.push(t),e.batchIds.push(t.batchId)}))},submitForm:function(t){var e=this;this.submitLoading=!0,this.$refs[t].validate((function(t){if(!t)return console.log("error submit!!"),e.submitLoading=!1,!1;Object(u["Kc"])(e.form).then((function(t){e.submitLoading=!1,console.log(t),e.closeDialogForm(),t.data.successful&&(e.$message({showClose:!0,message:"操作成功",type:"success"}),e.getTable())}))}))},showEdit:function(t,e){if(this.dialogTitle=t,this.dialogFormVisible=!0,e){var a=JSON.parse(JSON.stringify(e));this.form=a,this.form.batch=a.batchT,this.form.speciality=a.specialityT}},closeDialogForm:function(){this.dialogFormVisible=!1,this.form={reportStartDate:"",reportFinishDate:"",auditStartDate:"",auditFinishDate:"",batchName:"",batch:"",speciality:""},this.resetForm("form")},resetForm:function(t){this.$refs[t].resetFields()},disabledReportStartDate:function(t){var e=this;return t>Date.parse(new Date(e.form.reportFinishDate))||t.getTime()<Date.now()-864e5},disabledReportFinishDate:function(t){var e=this;return t<Date.parse(new Date(e.form.reportStartDate))||t.getTime()<Date.now()-864e5},disabledAuditStartDate:function(t){var e=this;return t>Date.parse(new Date(e.form.auditFinishDate))},disabledAuditFinishDate:function(t){var e=this;return t<Date.parse(new Date(e.form.auditStartDate))},disabledDate:function(t){var e=this;return t<Date.parse(new Date(e.param.reportStartDate))},disabledDateStart:function(t){var e=this;return t>Date.parse(new Date(e.param.reportFinishDate))},changeDate:function(t){},handleSizeChange:function(t){console.log("每页 ".concat(t," 条")),this.param.pageSize=t,this.getTable()},handleCurrentChange:function(t){console.log("当前页: ".concat(t)),this.param.pageIndex=t,this.getTable()},getRowKeys:function(t){return t.batchId},selectItem:function(){console.log(this.param),this.getTable()},getTable:function(){var t=this;t.tableLoading=!0,Object(u["Ic"])(t.param).then((function(e){console.log(e),t.tableLoading=!1,e.data.successful&&(t.tableData=e.data.resultValue.resultList,t.totalNum=e.data.resultValue.total,console.log("selectParamDict",t.selectParamDict),t.tableShowData=t.getShowDateTable(t.tableData))}))},getShowDateTable:function(t){var e=this,a=this.selectParamDict.get("speciality");return t.forEach((function(t,r){"1"==t.batchStatus?t.batchStatus="已发布":t.batchStatus="未发布",t.reportFinishDate=e.formartDate(t.reportFinishDate),t.reportStartDate=e.formartDate(t.reportStartDate),t.auditFinishDate=e.formartDate(t.auditFinishDate),t.auditStartDate=e.formartDate(t.auditStartDate),a&&a.forEach((function(e,a){t.speciality==e.codeValue&&(t.speciality=e.codeName,t.specialityT=e.codeValue)}))})),console.log(t),t},getItemLabel:function(){var t=this;Object(u["Vc"])().then((function(e){if(console.log("response",e),e.data.successful){e.data.resultValue.tableLable;t.selectParamDict.set("voltLevel",e.data.resultValue.voltCodeList),t.selectParamDict.set("itemLevel",e.data.resultValue.itemLevelList),t.selectParamDict.set("itemSource",e.data.resultValue.itemSourceList),t.selectParamDict.set("speciality",e.data.resultValue.specialityList),t.$forceUpdate(),t.getTable()}}))},formartDate:function(t){var e=new Date(t),a=e.getFullYear(),r=e.getMonth()+1,i=e.getDate();return a+"-"+this.add0(r)+"-"+this.add0(i)},add0:function(t){return t<10?"0"+t:t}}},m=p,h=(a("b020"),a("9a0c"),a("2877")),b=Object(h["a"])(m,r,i,!1,null,"4c127caa",null);e["default"]=b.exports},"8e15":function(t,e,a){},"9a0c":function(t,e,a){"use strict";var r=a("8e15"),i=a.n(r);i.a},b020:function(t,e,a){"use strict";var r=a("dd7d"),i=a.n(r);i.a},dd7d:function(t,e,a){}}]);
//# sourceMappingURL=chunk-02d63040.c893cdec.js.map